<?xml version="1.0" encoding="UTF-8"?>
<project basedir="." name="xml2json">
    <path id="cp">
       <pathelement location="C:/Users/cs79en/.m2/repository/net/sf/saxon/Saxon-HE/10.5/Saxon-HE-10.5.jar" />
       <pathelement location="target/classes"/>
    </path>
    <target name="xml2json" depends="xmlsqlast-shorten,xmlsqlast-json-structure,json-structure-to-json"/>
    <macrodef name="doxslt">
        <attribute name="extension" default=".xml"/>
        <attribute name="basedir" default="target/sqlxmlast"/>
        <attribute name="destdir" default="target/sqlxmlshort"/>
        <attribute name="style" default="src/main/stylesheets/sqlxmlast-shorten.xsl"/>
        <sequential>
            <xslt extension="@{extension}" basedir="@{basedir}" destdir="@{destdir}"
                  style="@{style}">
                <factory name="net.sf.saxon.TransformerFactoryImpl"/>
                <classpath refid="cp"/>
                <include name="**/*.xml"/>
            </xslt>
        </sequential>
    </macrodef>
    <target name="xmlsqlast-shorten">
        <doxslt extension=".xml" basedir="target/sqlxmlast" destdir="target/sqlxmlshort"
              style="src/main/stylesheets/sqlxmlast-shorten.xsl"/>
    </target>
    <target name="xmlsqlast-json-structure">
        <doxslt extension=".xml" basedir="target/sqlxmlshort" destdir="target/sqlxmljson"
            style="src/main/stylesheets/sqlxmlast-json-stucture.xsl"/>
    </target>
    <target name="json-structure-to-json">
        <doxslt extension=".json" basedir="target/sqlxmljson" destdir="target/jsonast"
            style="src/main/stylesheets/sqlxmlast-to-json.xsl"/>
    </target>
    <target name="xmlsqlast-html">
        <doxslt extension=".html" basedir="target/sqlxmlshort" destdir="target/html"
                style="src/main/stylesheets/sqlxmlast-short-html.xsl"/>
        <copy file="src/main/stylesheets/ft-syntax-highlight.css" tofile="target/html/ft-syntax-highlight.css"/>
    </target>
    <target name="clean">
        <delete dir="target/sqlxmlshort"/>
        <delete dir="target/sqlxmljson"/>
        <delete dir="target/sqljsonast"/>
        <delete dir="target/html"/>
    </target>
    <target name="zip">
        <zip destfile="target/xmljson-ast-samples.zip">
            <zipfileset dir="examples" prefix="sql"/>
            <zipfileset dir="target/sqlxmlast" prefix="sqlxmlast"/>
            <zipfileset dir="target/sqlxmlshort" prefix="sqlxmlshort"/>
            <zipfileset dir="target/sqlxmljson" prefix="sqlxmljson"/>
            <zipfileset dir="target/sqljsonast" prefix="sqljsonast"/>
            <zipfileset dir="src/main/antlr4/nl/xs4all/home/ei/parsers/antlr" prefix="grammars"/>
            <zipfileset dir="src/main/stylesheets" prefix="xslt"/>
        </zip>
    </target>
</project>
